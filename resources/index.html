<html>
<head>
<meta charset="UTF-8">
<!--Import materialize.css-->
 <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>
  <!--Let browser know website is optimized for mobile-->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>

<title>Be happy</title>
</head>
<body>
	<nav>
    	<div class="nav-wrapper">
    		<a href="#" class="brand-logo">&nbsp;&nbsp;&nbsp;&nbsp;Free music</a>
    		<ul id="nav-mobile" class="right hide-on-med-and-down">
      			<li><a id='suggest' href="#">提点意见</a></li>
    		</ul>
    	</div>
  	</nav>

	<div class="row" style="text-align: center;max-width: 888px">
        <div class="input-field col s12">
          <input id="url" type="text" class="validate">
          <label id="urllabel" for="url">歌曲链接(支持单曲，专辑，精选集，例:http://www.xiami.com/song/1775256504?spm=a1z1s.3521865.23309997.35.7EnexJ)</label>
        </div>
		<div>
		 	<a id="getSong" class="btn-floating btn-large waves-effect waves-light blue">
 				<i class="mdi-action-search"></i>
 			</a>
 		</div>

 		<div id="result" class="collection" style='border-width: 0px;'></div>

  </div>

  <div id='suggestDiv' class="grey lighten-3 z-depth-4" style='display:none;width:400px; position: fixed; top: 35%; left: 50%; margin-left:-200px;'>
    <div class="row">
      <form class="col s12">
        <div class="row">
          <div class="input-field col s10">
            <i class="mdi-editor-mode-edit prefix"></i>
            <textarea id="suggestInfo" class="materialize-textarea"></textarea>
            <label for="suggestInfo">写下你的建议</label>
          </div>
        </div>
      </form>
    </div>
    <div style='margin-left: 130px;margin-bottom: 20px'>
      <button id='submitBtn' class="btn waves-effect waves-light" type="submit" name="action">提交
        <i class="mdi-content-send right"></i>
      </button>
    </div>
  </div>

<!--Import jQuery before materialize.js-->
<script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="js/materialize.min.js"></script>
<script type="text/javascript">
	$(document).ready(function(){
    	$("#getSong").click(function(){
    		var url = $("#url").val();
    		if("" == url){
    			$("#urllabel").html("<font color='red'>下载链接不能为空</font>");
    			return;
    		}
    		$.get("http://localhost:8080/xmusic?song_url="+url,function(result){
    			$("#result").html("");
    			for(var i=0;i<result.length;i++){
    				data = result[i]
    				title = data['title']
    				pic = data['pic']
    				html = '<a href="'+data['location']+'"><div style="padding:30px;float:left;"><div>'+title+'</div><img id="pic'+i+'" src="'+pic+'"/></div></a>';
    				$("#result").append(html);
    			}

    		},"json");
    	});

      $("#suggest").click(function(){
          $("#suggestDiv").show();
      });

      $("#submitBtn").click(function(){
          suggestInfo = $("#suggestInfo").val();
          if("" == suggestInfo){
            $("#suggestDiv").hide();
            return;
          }
          $.post("http://localhost:8080/suggest",{'info':suggestInfo},function(){
            $("#suggestDiv").hide();
          });
      });

    });
</script>
</body>
</html>